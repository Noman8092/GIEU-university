{% extends "base.html" %}

{% for item in gallery_data %}
  <div class="col-lg-3 col-md-4 col-sm-6 col-12 gallery-item {{ item.tag }}">
    <div class="gallery-card position-relative">
      <a href="#" data-bs-toggle="modal" data-bs-target="#lightboxModal"
         data-img="{{ url_for('static', filename='images/gallery/' ~ item.file) }}"
         data-title="{{ item.title }}"
         data-desc="{{ item.desc }}">
        <img src="{{ url_for('static', filename='images/gallery/' ~ item.file) }}"
             alt="{{ item.title }}" loading="lazy"
             class="img-fluid gallery-img rounded shadow-sm">
      </a>
      <div class="caption-overlay">
        <div class="caption-text">
          <h6 class="mb-1">{{ item.title }}</h6>
          <small>{{ item.desc }}</small>
        </div>
      </div>
    </div>
  </div>
{% endfor %}













{% block content %}
<section class="py-5" style="background: linear-gradient(to right, #0f2027, #203a43, #2c5364);">
  <div class="container">
    <!-- Typing Heading -->
    <h1 class="text-center text-white mb-5">
      <span id="typing-text" class="fw-bold"></span><span class="blinking-cursor">|</span>
    </h1>

    <!-- Filter Buttons -->
    <div class="text-center mb-4">
      <button class="btn btn-outline-light mx-1 filter-btn active" data-filter="all">All</button>
      <button class="btn btn-outline-light mx-1 filter-btn" data-filter="faculty">Faculty</button>
      <button class="btn btn-outline-light mx-1 filter-btn" data-filter="event">Events</button>
    </div>

    <!-- Gallery Grid -->
    <div class="row g-4">
      {% set gallery_data = [
        {'file': 'gallery1.jpg', 'title': 'Dr. A. Rahman', 'desc': 'Mathematics Dept.', 'tag': 'faculty'},
        {'file': 'gallery2.jpg', 'title': 'Ms. Fatima Noor', 'desc': 'Computer Science', 'tag': 'faculty'},
        {'file': 'gallery3.jpg', 'title': 'Mr. Imran Khan', 'desc': 'Physics Lab', 'tag': 'faculty'},
        {'file': 'gallery4.jpg', 'title': 'Team Seminar', 'desc': 'Event snapshot', 'tag': 'event'},
        {'file': 'gallery5.jpg', 'title': 'Award Ceremony', 'desc': 'Best Faculty Award', 'tag': 'event'},
        {'file': 'gallery6.jpg', 'title': 'Research Day', 'desc': 'Project showcase', 'tag': 'event'},
        {'file': 'gallery7.jpg', 'title': 'Dr. Sana Ali', 'desc': 'Biology Lab', 'tag': 'faculty'},
        {'file': 'gallery8.jpg', 'title': 'Mr. Tariq Mehmood', 'desc': 'Library Tour', 'tag': 'event'},
        {'file': 'gallery2.jpg', 'title': 'Alumni Meetup', 'desc': 'Graduates Reunited', 'tag': 'event'},
        {'file': 'gallery10.jpg', 'title': 'Ms. Zara Khan', 'desc': 'Chemistry Lab', 'tag': 'faculty'},
        {'file': 'gallery11.jpg', 'title': 'Cultural Day', 'desc': 'Traditional Wear Show', 'tag': 'event'},
        {'file': 'gallery1.jpg', 'title': 'Dr. Umair Saleem', 'desc': 'Statistics Dept.', 'tag': 'faculty'},
        {'file': 'gallery1.jpg', 'title': 'Convocation', 'desc': 'Degree Distribution', 'tag': 'event'},
        {'file': 'gallery11.jpg', 'title': 'Ms. Hina Shah', 'desc': 'Linguistics Class', 'tag': 'faculty'},
        {'file': 'gallery15.jpg', 'title': 'Mr. Bilal Qureshi', 'desc': 'Engineering Dept.', 'tag': 'faculty'},
        {'file': 'gallery16.jpg', 'title': 'Orientation Day', 'desc': 'Welcoming Ceremony', 'tag': 'event'},
        {'file': 'gallery17.jpg', 'title': 'Dr. Neha Farooq', 'desc': 'Medical Sciences', 'tag': 'faculty'},
      ] %}

      {% for item in gallery_data %}
      <div class="col-lg-3 col-md-4 col-sm-6 col-12 gallery-item {{ item.tag }}">
        <div class="gallery-card position-relative">
          <a href="#" data-bs-toggle="modal" data-bs-target="#lightboxModal"
             data-img="{{ url_for('static', filename='images/' ~ item.file) }}"
             data-title="{{ item.title }}"
             data-desc="{{ item.desc }}">
            <img src="{{ url_for('static', filename='images/' ~ item.file) }}"
                 alt="{{ item.title }}" loading="lazy"
                 class="img-fluid gallery-img rounded shadow-sm">
          </a>
          <div class="caption-overlay">
            <div class="caption-text">
              <h6 class="mb-1">{{ item.title }}</h6>
              <small>{{ item.desc }}</small>
            </div>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>
</section>

<!-- Modal -->
<div class="modal fade" id="lightboxModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-fullscreen">
    <div class="modal-content bg-dark text-white border-0">
      <div class="modal-header border-0">
        <h5 class="modal-title" id="lightboxTitle"></h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body text-center">
        <img id="lightboxImage" src="" class="img-fluid rounded mb-3" alt="Enlarged">
        <p id="lightboxDesc" class="small text-muted"></p>
        <div>
          <button id="prevBtn" class="btn btn-outline-light me-2">&laquo; Prev</button>
          <button id="nextBtn" class="btn btn-outline-light">Next &raquo;</button>
          <a id="downloadBtn" class="btn btn-success ms-2" download target="_blank">Download</a>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
  .gallery-img {
    height: 230px;
    width: 100%;
    object-fit: cover;
    transition: transform 0.4s ease;
    cursor: pointer;
    border-radius: 12px;
  }
  .gallery-img:hover {
    transform: scale(1.05);
  }
  .gallery-card {
    position: relative;
    overflow: hidden;
    border-radius: 12px;
  }
  .caption-overlay {
    position: absolute;
    bottom: 0;
    width: 100%;
    background: rgba(15, 32, 39, 0.7);
    color: #fff;
    padding: 8px 10px;
    text-align: left;
  }
  .blinking-cursor {
    color: white;
    animation: blink 1s step-start infinite;
  }
  @keyframes blink {
    50% { opacity: 0; }
  }
  .filter-btn.active {
    background-color: white;
    color: #203a43;
    font-weight: bold;
  }
</style>

<script>
  
  const text = "Explore Our Moments";
  let index = 0;
  function typeWriter() {
    if (index < text.length) {
      document.getElementById("typing-text").innerHTML += text.charAt(index);
      index++;
      setTimeout(typeWriter, 100);
    }
  }
  window.onload = typeWriter;

  const modal = document.getElementById('lightboxModal');
  let gallery = Array.from(document.querySelectorAll('.gallery-item a'));
  let currentIndex = 0;

  function showImage(index) {
    const item = gallery[index];
    if (!item) return;
    const img = item.getAttribute('data-img');
    const title = item.getAttribute('data-title');
    const desc = item.getAttribute('data-desc');
    document.getElementById('lightboxImage').src = img;
    document.getElementById('lightboxTitle').textContent = title;
    document.getElementById('lightboxDesc').textContent = desc;
    document.getElementById('downloadBtn').href = img;
  }

  gallery.forEach((a, i) => {
    a.addEventListener('click', () => { currentIndex = i; });
  });

  modal.addEventListener('show.bs.modal', function () {
    showImage(currentIndex);
  });

  document.getElementById('prevBtn').addEventListener('click', () => {
    currentIndex = (currentIndex - 1 + gallery.length) % gallery.length;
    showImage(currentIndex);
  });

  document.getElementById('nextBtn').addEventListener('click', () => {
    currentIndex = (currentIndex + 1) % gallery.length;
    showImage(currentIndex);
  });

  document.querySelectorAll('.filter-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      const filter = btn.getAttribute('data-filter');
      document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      document.querySelectorAll('.gallery-item').forEach(item => {
        item.style.display = (filter === 'all' || item.classList.contains(filter)) ? 'block' : 'none';
      });
    });
  });
</script>
{% endblock %}
